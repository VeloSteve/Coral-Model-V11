<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="44,1" id="srcline1">  1</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%% 2nd ORDER RUNGE-KUTTA for two variables with limits to prevent cold water bleaching.</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,3" id="srcline3">  3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="44,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% Runge-Kutta is a temporal discretization to approximate solutions for </span></span></span>
<span class="srcline"><span class="lineno"><a href="44,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% ordinary differential equations</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,6" id="srcline6">  6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="44,7" id="srcline7">  7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="44,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% Evolutionary model for coral cover (from Baskett et al. 2009)     %</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">% modified by Cheryl Logan (clogan@csumb.edu)                       %</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% 12-1-15                                                           %</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,13" id="srcline13"> 13</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T5U3">Snew</span>, <span class="var type1" id="S3T5U4">Cnew</span>] = Runge_Kutta_2_min0_160914(<span class="var type1" id="S4T5U7">Sold</span>, <span class="var type1" id="S5T5U8">Cold</span>, <span class="var type1" id="S6T2U9">i</span>, <span class="var type1" id="S7T2U10">dt</span>, <span class="var type1" id="S8T1U11">ri</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,14" id="srcline14"> 14</a></span><span class="line">                            <span class="var type1" id="S9T2U12">rm</span>, <span class="var type1" id="S10T3U13">temp</span>, <span class="var type1" id="S11T1U14">vgi</span>, <span class="var type1" id="S12T1U15">gi</span>, <span class="var type1" id="S13T5U16">SelVx</span>, <span class="var type1" id="S14T6U17">C_seed</span>, <span class="var type1" id="S15T5U18">S_seed</span>, <span class="var type1" id="S16T8U19">con</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="44,15" id="srcline15"> 15</a></span><span class="line">	<span class="comment">% Inputs:</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,16" id="srcline16"> 16</a></span><span class="line">    <span class="comment">% Sold - symbiont populations - "S old" the i'th row of the S array</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,17" id="srcline17"> 17</a></span><span class="line">    <span class="comment">% Cold - coral populations - "C old" the i'th row of the C array</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,18" id="srcline18"> 18</a></span><span class="line">    <span class="comment">% i - time step in the calling for loop</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,19" id="srcline19"> 19</a></span><span class="line">    <span class="comment">% dt - timestep set in Interp_data.m</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,20" id="srcline20"> 20</a></span><span class="line">    <span class="comment">% ri - values set for each time step to prevent cold water bleaching</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,21" id="srcline21"> 21</a></span><span class="line">    <span class="comment">% rm - maximum growth rate</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,22" id="srcline22"> 22</a></span><span class="line">    <span class="comment">% temp - temperatures initialized by Interp_data</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,23" id="srcline23"> 23</a></span><span class="line">    <span class="comment">% vgi - 2D array, the same size as S and C, with symbiont variance.</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,24" id="srcline24"> 24</a></span><span class="line">    <span class="comment">% gi  - Symbiont mean genotype over time</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,25" id="srcline25"> 25</a></span><span class="line">    <span class="comment">% SelVx - Selectional variance matrix for coral calcs</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,26" id="srcline26"> 26</a></span><span class="line">    <span class="comment">% C_seed and S_seed - minimum values for coral and symbiont density.</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,27" id="srcline27"> 27</a></span><span class="line">    <span class="comment">% Constants from the "con" structure, called coralSymConstants in the</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,28" id="srcline28"> 28</a></span><span class="line">    <span class="comment">% main program.  </span></span></span>
<span class="srcline"><span class="lineno"><a href="44,29" id="srcline29"> 29</a></span><span class="line">    <span class="comment">% con is the only optional variable, speeding calls when it is not</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,30" id="srcline30"> 30</a></span><span class="line">    <span class="comment">% needed.</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,31" id="srcline31"> 31</a></span><span class="line">        <span class="comment">% Sn - number of symbionts modeled</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,32" id="srcline32"> 32</a></span><span class="line">        <span class="comment">% KSx - symbiont carrying capacities from Baskett 2009</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,33" id="srcline33"> 33</a></span><span class="line">        <span class="comment">% G  - constants from the Coral_Sym_constants file  ?</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,34" id="srcline34"> 34</a></span><span class="line">        <span class="comment">% KS - same symbiont capacities as KSx   XXX</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,35" id="srcline35"> 35</a></span><span class="line">        <span class="comment">% KC - coral carrying capacities from Baskett 2009</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,36" id="srcline36"> 36</a></span><span class="line">        <span class="comment">% A - competition coefficients from Baskett 2009</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,37" id="srcline37"> 37</a></span><span class="line">        <span class="comment">% Mu - constants from the Coral_Sym_constants file - basal mortality</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,38" id="srcline38"> 38</a></span><span class="line">        <span class="comment">% um - symbiont influence on mortality from Baskett 2009    </span></span></span>
<span class="srcline"><span class="lineno"><a href="44,39" id="srcline39"> 39</a></span><span class="line">        <span class="comment">% a   - linear growth rate, 1/12 of the value in Baskett 2009</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,40" id="srcline40"> 40</a></span><span class="line">        <span class="comment">% b   - exponential growth constant from Baskett 2009 (not divided by 12)</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,41" id="srcline41"> 41</a></span><span class="line">        <span class="comment">% EnvV - environmental variance from Baskett 2009</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,42" id="srcline42"> 42</a></span><span class="line">        <span class="comment">% EnvVx - EnvV copied once per symbiont type</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,43" id="srcline43"> 43</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="44,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo " id="T2:U16"><span class="var type1" id="S17T2U22">Sn</span>    = <span class="mxinfo " id="T2:U18"><span class="var type1" id="S16T8U24">con</span>.Sn</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,45" id="srcline45"> 45</a></span><span class="line">    <span class="mxinfo " id="T5:U20"><span class="var type1" id="S18T5U28">KSx</span>   = <span class="mxinfo " id="T5:U22"><span class="var type1" id="S16T8U30">con</span>.KSx</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,46" id="srcline46"> 46</a></span><span class="line">    <span class="mxinfo " id="T6:U24"><span class="var type1" id="S19T6U34">G</span>     = <span class="mxinfo " id="T6:U26"><span class="var type1" id="S16T8U36">con</span>.G</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,47" id="srcline47"> 47</a></span><span class="line">    <span class="mxinfo " id="T6:U28"><span class="var type1" id="S20T6U40">KS</span>    = <span class="mxinfo " id="T6:U30"><span class="var type1" id="S16T8U42">con</span>.KS</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,48" id="srcline48"> 48</a></span><span class="line">    <span class="mxinfo " id="T6:U32"><span class="var type1" id="S21T6U46">KC</span>    = <span class="mxinfo " id="T6:U34"><span class="var type1" id="S16T8U48">con</span>.KC</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,49" id="srcline49"> 49</a></span><span class="line">    <span class="mxinfo " id="T6:U36"><span class="var type1" id="S22T6U52">A</span>     = <span class="mxinfo " id="T6:U38"><span class="var type1" id="S16T8U54">con</span>.A</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,50" id="srcline50"> 50</a></span><span class="line">    <span class="mxinfo " id="T6:U40"><span class="var type1" id="S23T6U58">Mu</span>    = <span class="mxinfo " id="T6:U42"><span class="var type1" id="S16T8U60">con</span>.Mu</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,51" id="srcline51"> 51</a></span><span class="line">    <span class="mxinfo " id="T6:U44"><span class="var type1" id="S24T6U64">um</span>    = <span class="mxinfo " id="T6:U46"><span class="var type1" id="S16T8U66">con</span>.um</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,52" id="srcline52"> 52</a></span><span class="line">    <span class="mxinfo " id="T2:U48"><span class="var type1" id="S25T2U70">a</span>     = <span class="mxinfo " id="T2:U50"><span class="var type1" id="S16T8U72">con</span>.a</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,53" id="srcline53"> 53</a></span><span class="line">    <span class="mxinfo " id="T2:U52"><span class="var type1" id="S26T2U76">b</span>     = <span class="mxinfo " id="T2:U54"><span class="var type1" id="S16T8U78">con</span>.b</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,54" id="srcline54"> 54</a></span><span class="line">    <span class="mxinfo " id="T5:U56"><span class="var type1" id="S27T5U82">EnvVx</span> = <span class="mxinfo " id="T5:U58"><span class="var type1" id="S16T8U84">con</span>.EnvVx</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,55" id="srcline55"> 55</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="44,56" id="srcline56"> 56</a></span><span class="line"><span class="comment">    <span class="comment">%{</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,57" id="srcline57"> 57</a></span><span class="line"><span class="comment">    Sm = Sold(1);            <span class="comment">% Sum of all symbionts on massive corals</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,58" id="srcline58"> 58</a></span><span class="line"><span class="comment">    Sb = Sold(2);            <span class="comment">% Sum of all symbionts on branching corals</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,59" id="srcline59"> 59</a></span><span class="line"><span class="comment">    SA = [Sm Sb];           <span class="comment">% Symbionts sum matrix for coral calcs</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">    if Sn &gt; 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,61" id="srcline61"> 61</a></span><span class="line"><span class="comment">        SAx = repmat(SA,1,Sn);  <span class="comment">% Symbionts sum matrix for symbiont calcs</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,62" id="srcline62"> 62</a></span><span class="line"><span class="comment">    else</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,63" id="srcline63"> 63</a></span><span class="line"><span class="comment">        SAx = SA;</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,64" id="srcline64"> 64</a></span><span class="line"><span class="comment">    end</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,65" id="srcline65"> 65</a></span><span class="line"><span class="comment">    <span class="comment">%}</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,66" id="srcline66"> 66</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="44,67" id="srcline67"> 67</a></span><span class="line">    <span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,68" id="srcline68"> 68</a></span><span class="line">    <span class="comment">% Note that storage order with two symbionts per coral time is</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,69" id="srcline69"> 69</a></span><span class="line">    <span class="comment">% massive1, branching1, massive2, branching2</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,70" id="srcline70"> 70</a></span><span class="line">    <span class="comment">% where we'll typically treat "1" as the wild or common symbiont type</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,71" id="srcline71"> 71</a></span><span class="line">    <span class="comment">% and "2" as an introduced or other alternate type.</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,72" id="srcline72"> 72</a></span><span class="line">    <span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,73" id="srcline73"> 73</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="44,74" id="srcline74"> 74</a></span><span class="line">    <span class="mxinfo " id="T2:U60"><span class="var type1" id="S28T2U88">Sm</span> = <span class="mxinfo " id="T2:U62">sum(<span class="mxinfo " id="T6:U63"><span class="var type1" id="S4T5U92">Sold</span>(1:2:end)</span>)</span></span>;  <span class="comment">% Sum symbionts in massives</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,75" id="srcline75"> 75</a></span><span class="line">    <span class="mxinfo " id="T2:U65"><span class="var type1" id="S31T2U101">Sb</span> = <span class="mxinfo " id="T2:U67">sum(<span class="mxinfo " id="T6:U68"><span class="var type1" id="S4T5U105">Sold</span>(2:2:end)</span>)</span></span>;  <span class="comment">% Sum symbionts in branching</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,76" id="srcline76"> 76</a></span><span class="line">    <span class="mxinfo " id="T6:U70"><span class="var type1" id="S32T6U114">SA</span> = <span class="mxinfo " id="T6:U72">[<span class="var type1" id="S28T2U117">Sm</span> <span class="var type1" id="S31T2U118">Sb</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,77" id="srcline77"> 77</a></span><span class="line">    <span class="comment">% SAx = Sold(1, :);  % replaced 1/30/2017 with line below</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,78" id="srcline78"> 78</a></span><span class="line">    <span class="mxinfo " id="T5:U75"><span class="var type1" id="S33T5U121">SAx</span> = <span class="mxinfo " id="T5:U77">repmat(<span class="var type1" id="S32T6U124">SA</span>, 1, 2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,79" id="srcline79"> 79</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="44,80" id="srcline80"> 80</a></span><span class="line">    <span class="mxinfo " id="T6:U79"><span class="var type1" id="S35T6U129">C1</span> = <span class="mxinfo " id="T6:U81">[<span class="mxinfo " id="T2:U82"><span class="var type1" id="S5T5U133">Cold</span>(<span class="mxinfo " id="T2:U84">2</span>)</span> <span class="mxinfo " id="T2:U85"><span class="var type1" id="S5T5U136">Cold</span>(<span class="mxinfo " id="T2:U87">1</span>)</span>]</span></span>;   <span class="comment">% [branch mass]</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,81" id="srcline81"> 81</a></span><span class="line">    <span class="mxinfo " id="T6:U88"><span class="var type1" id="S36T6U140">C2</span> = <span class="mxinfo " id="T6:U90">[<span class="mxinfo " id="T2:U91"><span class="var type1" id="S5T5U144">Cold</span>(<span class="mxinfo " id="T2:U93">1</span>)</span> <span class="mxinfo " id="T2:U94"><span class="var type1" id="S5T5U147">Cold</span>(<span class="mxinfo " id="T2:U96">2</span>)</span>]</span></span>;   <span class="comment">% [mass branch]</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,82" id="srcline82"> 82</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="44,83" id="srcline83"> 83</a></span><span class="line">    <span class="comment">% Baskett 2009 equations 4 and 5.  k1 indicates the derivative at t sub i</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,84" id="srcline84"> 84</a></span><span class="line">    <span class="mxinfo " id="T5:U97"><span class="var type1" id="S37T5U151">dSk1</span> = <span class="mxinfo " id="T5:U99"><span class="mxinfo " id="T5:U100"><span class="mxinfo " id="T5:U101"><span class="var type1" id="S7T2U155">dt</span> .* <span class="var type1" id="S4T5U156">Sold</span></span> ./ (<span class="mxinfo " id="T5:U104"><span class="var type1" id="S18T5U159">KSx</span> .* <span class="var type1" id="S5T5U160">Cold</span></span>)</span> .* (<span class="mxinfo " id="T5:U107"><span class="mxinfo " id="T5:U108"><span class="mxinfo " id="T5:U109"><span class="mxinfo " id="T5:U110"><span class="var type1" id="S8T1U166">ri</span>(<span class="var type1" id="S6T2U167">i</span>,<span class="mxinfo " id="T9:U113">:</span>)</span> .* <span class="var type1" id="S18T5U169">KSx</span></span> .* <span class="var type1" id="S5T5U170">Cold</span></span> - <span class="mxinfo " id="T5:U116"><span class="var type1" id="S9T2U172">rm</span> .* <span class="var type1" id="S33T5U173">SAx</span></span></span> )</span></span> ;  <span class="comment">%Change in symbiont pops %OK</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,85" id="srcline85"> 85</a></span><span class="line">    <span class="mxinfo " id="T6:U119"><span class="var type1" id="S38T6U176">dCk1</span> = <span class="mxinfo " id="T6:U121"><span class="var type1" id="S7T2U178">dt</span> .* (<span class="mxinfo " id="T6:U123"><span class="var type1" id="S36T6U181">C2</span> .* (<span class="mxinfo " id="T6:U125"><span class="mxinfo " id="T6:U126"><span class="mxinfo " id="T6:U127"><span class="mxinfo " id="T6:U128"><span class="mxinfo " id="T6:U129"><span class="var type1" id="S19T6U188">G</span> .* <span class="var type1" id="S32T6U189">SA</span></span>./ (<span class="mxinfo " id="T6:U132"><span class="var type1" id="S20T6U192">KS</span> .* <span class="var type1" id="S36T6U193">C2</span></span>)</span>.* (<span class="mxinfo " id="T6:U135"><span class="mxinfo " id="T6:U136"><span class="var type1" id="S21T6U197">KC</span>-<span class="mxinfo " id="T6:U138"><span class="var type1" id="S22T6U199">A</span> .* <span class="var type1" id="S35T6U200">C1</span></span></span>-<span class="var type1" id="S36T6U201">C2</span></span>)</span>./<span class="var type1" id="S21T6U202">KC</span></span> - <span class="mxinfo " id="T6:U143"><span class="var type1" id="S23T6U204">Mu</span> ./(<span class="mxinfo " id="T6:U145"><span class="mxinfo " id="T2:U146">1</span>+<span class="mxinfo " id="T6:U147"><span class="mxinfo " id="T6:U148"><span class="var type1" id="S24T6U210">um</span> .* <span class="var type1" id="S32T6U211">SA</span></span>./(<span class="mxinfo " id="T6:U151"><span class="var type1" id="S20T6U214">KS</span> .* <span class="var type1" id="S36T6U215">C2</span></span>)</span></span>)</span></span>)</span> )</span></span>; <span class="comment">%Change in coral pops %OK</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,86" id="srcline86"> 86</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="44,87" id="srcline87"> 87</a></span><span class="line">    <span class="comment">% Until 2/17/2017 the dSk1 array was being indexed as a 2D array, but</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,88" id="srcline88"> 88</a></span><span class="line">    <span class="comment">% it's just 1 x number of symbionts!</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,89" id="srcline89"> 89</a></span><span class="line">    <span class="mxinfo " id="T2:U154"><span class="var type1" id="S39T2U218">dSm</span> = <span class="mxinfo " id="T2:U156">sum(<span class="mxinfo " id="T6:U157"><span class="var type1" id="S37T5U222">dSk1</span>(1:2:end)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,90" id="srcline90"> 90</a></span><span class="line">    <span class="mxinfo " id="T2:U159"><span class="var type1" id="S40T2U231">dSb</span> = <span class="mxinfo " id="T2:U161">sum(<span class="mxinfo " id="T6:U162"><span class="var type1" id="S37T5U235">dSk1</span>(2:2:end)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,91" id="srcline91"> 91</a></span><span class="line">    <span class="comment">%dSm = dSk1(1,1); % change in sum of all symbionts on massive corals</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,92" id="srcline92"> 92</a></span><span class="line">    <span class="comment">%dSb = dSk1(1,2); % change in sum of all symbionts on branching corals</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,93" id="srcline93"> 93</a></span><span class="line">    <span class="comment">% not used. dS  = [dSm dSb];           % change in sum of all symbionts matrix for coral calcs</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,94" id="srcline94"> 94</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="44,95" id="srcline95"> 95</a></span><span class="line">    <span class="mxinfo " id="T2:U164"><span class="var type1" id="S41T2U244">ctemp</span> = <span class="mxinfo " id="T2:U166"><span class="mxinfo " id="T2:U167"><span class="var type1" id="S10T3U247">temp</span>(<span class="var type1" id="S6T2U248">i</span>)</span>+<span class="mxinfo " id="T2:U170"><span class="var type1" id="S10T3U250">temp</span>(<span class="mxinfo " id="T2:U172"><span class="var type1" id="S6T2U252">i</span>+<span class="mxinfo " id="T2:U174">1</span></span>)</span></span></span>;    <span class="comment">% current temp step</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,96" id="srcline96"> 96</a></span><span class="line">    <span class="mxinfo " id="T2:U175"><span class="var type1" id="S42T2U256">rmk2</span>  = <span class="mxinfo " id="T2:U177"><span class="var type1" id="S25T2U258">a</span>*<span class="mxinfo " id="T2:U179">exp(<span class="mxinfo " id="T2:U180"><span class="mxinfo " id="T2:U181"><span class="var type1" id="S26T2U263">b</span>*<span class="mxinfo " id="T2:U183">0.5</span></span>*(<span class="var type1" id="S41T2U266">ctemp</span>)</span>)</span></span></span>; <span class="comment">% maximum possible growth rate at optimal temp at t=i+0.5</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,97" id="srcline97"> 97</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="44,98" id="srcline98"> 98</a></span><span class="line">    <span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,99" id="srcline99"> 99</a></span><span class="line">    <span class="comment">% Note that this line is analagous to the one for ri in timeIteration,</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,100" id="srcline100">100</a></span><span class="line">    <span class="comment">% so it should be modified in sync with it!</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,101" id="srcline101">101</a></span><span class="line">    <span class="comment">%rik2  =   (1- (vgi(i,:) + EnvVx + (min(0, gi(i,:) - 0.5*ctemp)).^2)./(2*SelVx)) * rmk2; % symbiont average growth rate at t=i+0.5</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,102" id="srcline102">102</a></span><span class="line">    <span class="comment">% modified rik2 above to prevent cold water bleaching Prevents cold water bleaching</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,103" id="srcline103">103</a></span><span class="line">    <span class="comment">% Test without the mod, 2/1/2017</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,104" id="srcline104">104</a></span><span class="line">    <span class="comment">%rik2  =   (1- (vgi(i,:) + EnvVx + (gi(i,:) - 0.5*ctemp).^2)./(2*SelVx)) * rmk2; % symbiont average growth rate at t=i+0.5</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,105" id="srcline105">105</a></span><span class="line">    <span class="comment">% And with partial mod to limit:</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,106" id="srcline106">106</a></span><span class="line">    <span class="comment">%rik2  =   (1- (vgi(i,:) + EnvVx + (min(1.0, gi(i,:) - 0.5*ctemp)).^2)./(2*SelVx)) * rmk2; % symbiont average growth rate at t=i+0.5</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,107" id="srcline107">107</a></span><span class="line">    <span class="comment">% Try decreasing growth rate in cooler water based on Eppley</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,108" id="srcline108">108</a></span><span class="line">    <span class="comment">% equation per John/Simon/Cheryl 2/8/2017.</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,109" id="srcline109">109</a></span><span class="line">    <span class="mxinfo " id="T5:U185"><span class="var type1" id="S44T5U269">rik2</span>   = <span class="mxinfo " id="T5:U187"><span class="mxinfo " id="T5:U188">(<span class="mxinfo " id="T5:U189"><span class="mxinfo " id="T2:U190">1</span>- <span class="mxinfo " id="T5:U191">(<span class="mxinfo " id="T5:U192"><span class="mxinfo " id="T5:U193"><span class="mxinfo " id="T5:U194"><span class="var type1" id="S11T1U280">vgi</span>(<span class="var type1" id="S6T2U281">i</span>,<span class="mxinfo " id="T9:U197">:</span>)</span> + <span class="var type1" id="S27T5U283">EnvVx</span></span> + <span class="mxinfo " id="T5:U199">(<span class="mxinfo " id="T5:U200">min(<span class="mxinfo " id="T2:U201">0</span>, <span class="mxinfo " id="T5:U202"><span class="mxinfo " id="T5:U203"><span class="var type1" id="S12T1U291">gi</span>(<span class="var type1" id="S6T2U292">i</span>,<span class="mxinfo " id="T9:U206">:</span>)</span> - <span class="mxinfo " id="T2:U207"><span class="mxinfo " id="T2:U208">0.5</span>*<span class="var type1" id="S41T2U296">ctemp</span></span></span>)</span>).^2</span></span>) ./ (<span class="mxinfo " id="T5:U210"><span class="mxinfo " id="T2:U211">2</span>*<span class="var type1" id="S13T5U301">SelVx</span></span>)</span></span>) .* <span class="mxinfo " id="T5:U213">exp(<span class="mxinfo " id="T5:U214"><span class="var type1" id="S26T2U305">b</span>*<span class="mxinfo " id="T5:U216">min(<span class="mxinfo " id="T2:U217">0</span>, <span class="mxinfo " id="T5:U218"><span class="var type1" id="S41T2U310">ctemp</span> - <span class="mxinfo " id="T5:U220"><span class="var type1" id="S12T1U312">gi</span>(<span class="var type1" id="S6T2U313">i</span>,<span class="mxinfo " id="T9:U223">:</span>)</span></span>)</span></span>)</span></span> * <span class="var type1" id="S42T2U315">rmk2</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="44,110" id="srcline110">110</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="44,111" id="srcline111">111</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="44,112" id="srcline112">112</a></span><span class="line">    <span class="mxinfo " id="T2:U225"><span class="var type1" id="S46T2U318">hCm</span> = <span class="mxinfo " id="T2:U227">max(<span class="mxinfo " id="T2:U228"><span class="mxinfo " id="T2:U229"><span class="var type1" id="S5T5U323">Cold</span>(<span class="mxinfo " id="T18:U231">1</span>)</span>+<span class="mxinfo " id="T2:U232"><span class="mxinfo " id="T2:U233">0.5</span>*<span class="mxinfo " id="T2:U234"><span class="var type1" id="S38T6U328">dCk1</span>(<span class="mxinfo " id="T2:U236">1</span>,<span class="mxinfo " id="T2:U237">1</span>)</span></span></span>, <span class="mxinfo " id="T2:U238"><span class="var type1" id="S14T6U332">C_seed</span>(<span class="mxinfo " id="T18:U240">1</span>)</span>)</span></span>;  <span class="comment">% Massive corals at t=i+0.5</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,113" id="srcline113">113</a></span><span class="line">    <span class="mxinfo " id="T2:U241"><span class="var type1" id="S48T2U336">hCb</span> = <span class="mxinfo " id="T2:U243">max(<span class="mxinfo " id="T2:U244"><span class="mxinfo " id="T2:U245"><span class="var type1" id="S5T5U341">Cold</span>(<span class="mxinfo " id="T18:U247">2</span>)</span>+<span class="mxinfo " id="T2:U248"><span class="mxinfo " id="T2:U249">0.5</span>*<span class="mxinfo " id="T2:U250"><span class="var type1" id="S38T6U346">dCk1</span>(<span class="mxinfo " id="T2:U252">1</span>,<span class="mxinfo " id="T2:U253">2</span>)</span></span></span>, <span class="mxinfo " id="T2:U254"><span class="var type1" id="S14T6U350">C_seed</span>(<span class="mxinfo " id="T18:U256">2</span>)</span>)</span></span>;  <span class="comment">% Branching corals at t=i+0.5</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,114" id="srcline114">114</a></span><span class="line">    <span class="mxinfo " id="T6:U257"><span class="var type1" id="S49T6U354">hC2</span> = <span class="mxinfo " id="T6:U259">[<span class="var type1" id="S46T2U357">hCm</span> <span class="var type1" id="S48T2U358">hCb</span>]</span></span>;             <span class="comment">% Coral pop matrix for coral calcs at t=i+0.5</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,115" id="srcline115">115</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T7:U262"><span class="var type1" id="S17T2U362">Sn</span> &gt; <span class="mxinfo " id="T2:U264">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,116" id="srcline116">116</a></span><span class="line">        <span class="mxinfo " id="T39:U265"><span class="var type1" id="S50T39U366">hCx</span> = <span class="mxinfo " id="T39:U267">repmat(<span class="var type1" id="S49T6U369">hC2</span>,1,<span class="var type1" id="S17T2U371">Sn</span>)</span></span>;      <span class="comment">% Coral pop matrix for symbiont calcs at t=i+0.5</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,117" id="srcline117">117</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,118" id="srcline118">118</a></span><span class="line">        <span class="mxinfo " id="T39:U270"><span class="var type1" id="S50T39U375">hCx</span> = <span class="var type1" id="S49T6U376">hC2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="44,119" id="srcline119">119</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,120" id="srcline120">120</a></span><span class="line">    <span class="mxinfo " id="T6:U273"><span class="var type1" id="S51T6U379">hC1</span> = <span class="mxinfo " id="T6:U275">[<span class="var type1" id="S48T2U382">hCb</span> <span class="var type1" id="S46T2U383">hCm</span>]</span></span>;             <span class="comment">% [branch mass]</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,121" id="srcline121">121</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="44,122" id="srcline122">122</a></span><span class="line"><span class="comment">    <span class="comment">%{</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,123" id="srcline123">123</a></span><span class="line"><span class="comment">    <span class="comment">% Old code assumes seeds are the same for all symbionts.  Change to use</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,124" id="srcline124">124</a></span><span class="line"><span class="comment">    <span class="comment">% unique values.  Also note that hSAx was never used!</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,125" id="srcline125">125</a></span><span class="line"><span class="comment">    hSm  = max(Sm+0.5*dSm, S_seed);       <span class="comment">% sum of all symbionts on massive corals at t=i+0.5</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,126" id="srcline126">126</a></span><span class="line"><span class="comment">    hSb  = max(Sb+0.5*dSb, S_seed);       <span class="comment">% sum of all symbionts on branching corals at t=i+0.5</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,127" id="srcline127">127</a></span><span class="line"><span class="comment">    hSA  = [hSm hSb];        <span class="comment">% Symbionts sum matrix for coral calcs at t=i+0.5</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,128" id="srcline128">128</a></span><span class="line"><span class="comment">    if Sn &gt; 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,129" id="srcline129">129</a></span><span class="line"><span class="comment">        hSAx = repmat(hSA,1,Sn); <span class="comment">% Symbionts sum matrix for symbionts calcs at t=i+0.5</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,130" id="srcline130">130</a></span><span class="line"><span class="comment">    else</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,131" id="srcline131">131</a></span><span class="line"><span class="comment">        hSAx = hSA;</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,132" id="srcline132">132</a></span><span class="line"><span class="comment">    end</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,133" id="srcline133">133</a></span><span class="line"><span class="comment">    <span class="comment">%}</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,134" id="srcline134">134</a></span><span class="line">    <span class="comment">% Sm, Sb, dSm, and dSb are scalars representing the sum of all</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,135" id="srcline135">135</a></span><span class="line">    <span class="comment">% symbionts for massive or branching and for the initial values and</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,136" id="srcline136">136</a></span><span class="line">    <span class="comment">% t+1/2 deltas.  S_seed was a scalar, but is now a 1x4 vector for the</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,137" id="srcline137">137</a></span><span class="line">    <span class="comment">% case of 2 corals and 2 symbionts.  We just want sums, since the coral</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,138" id="srcline138">138</a></span><span class="line">    <span class="comment">% is treated as 2 copies of the same thing.</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,139" id="srcline139">139</a></span><span class="line">    <span class="mxinfo " id="T2:U278"><span class="var type1" id="S52T2U386">hSm</span>  = <span class="mxinfo " id="T2:U280">max(<span class="mxinfo " id="T2:U281"><span class="var type1" id="S28T2U390">Sm</span>+<span class="mxinfo " id="T2:U283"><span class="mxinfo " id="T2:U284">0.5</span>*<span class="var type1" id="S39T2U393">dSm</span></span></span>, <span class="mxinfo " id="T2:U286">max(<span class="mxinfo " id="T2:U287"><span class="var type1" id="S15T5U397">S_seed</span>(<span class="mxinfo " id="T18:U289">1</span>)</span>, <span class="mxinfo " id="T2:U290"><span class="var type1" id="S15T5U400">S_seed</span>(<span class="mxinfo " id="T18:U292">3</span>)</span>)</span>)</span></span>;       <span class="comment">% sum of all symbionts on massive corals at t=i+0.5</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,140" id="srcline140">140</a></span><span class="line">    <span class="mxinfo " id="T2:U293"><span class="var type1" id="S53T2U404">hSb</span>  = <span class="mxinfo " id="T2:U295">max(<span class="mxinfo " id="T2:U296"><span class="var type1" id="S31T2U408">Sb</span>+<span class="mxinfo " id="T2:U298"><span class="mxinfo " id="T2:U299">0.5</span>*<span class="var type1" id="S40T2U411">dSb</span></span></span>, <span class="mxinfo " id="T2:U301">max(<span class="mxinfo " id="T2:U302"><span class="var type1" id="S15T5U415">S_seed</span>(<span class="mxinfo " id="T18:U304">2</span>)</span>, <span class="mxinfo " id="T2:U305"><span class="var type1" id="S15T5U418">S_seed</span>(<span class="mxinfo " id="T18:U307">4</span>)</span>)</span>)</span></span>;       <span class="comment">% sum of all symbionts on branching corals at t=i+0.5</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,141" id="srcline141">141</a></span><span class="line">    <span class="mxinfo " id="T6:U308"><span class="var type1" id="S54T6U422">hSA</span>  = <span class="mxinfo " id="T6:U310">[<span class="var type1" id="S52T2U425">hSm</span> <span class="var type1" id="S53T2U426">hSb</span>]</span></span>;        <span class="comment">% Symbionts sum matrix for coral calcs at t=i+0.5</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,142" id="srcline142">142</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="44,143" id="srcline143">143</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="44,144" id="srcline144">144</a></span><span class="line">    <span class="mxinfo " id="T5:U313"><span class="var type1" id="S55T5U429">dSk2</span> = <span class="mxinfo " id="T5:U315"><span class="mxinfo " id="T5:U316"><span class="mxinfo " id="T5:U317"><span class="var type1" id="S7T2U433">dt</span>*(<span class="mxinfo " id="T5:U319"><span class="var type1" id="S4T5U436">Sold</span>+<span class="mxinfo " id="T5:U321"><span class="mxinfo " id="T2:U322">0.5</span>*<span class="var type1" id="S37T5U439">dSk1</span></span></span>)</span> ./ (<span class="mxinfo " id="T5:U324"><span class="var type1" id="S18T5U442">KSx</span>.*<span class="var type1" id="S50T39U443">hCx</span></span>)</span> .* (<span class="mxinfo " id="T5:U327"><span class="mxinfo " id="T5:U328"><span class="mxinfo " id="T5:U329"><span class="var type1" id="S44T5U448">rik2</span>.* <span class="var type1" id="S18T5U449">KSx</span></span>.*<span class="var type1" id="S50T39U450">hCx</span></span> - <span class="mxinfo " id="T5:U333"><span class="var type1" id="S42T2U452">rmk2</span> * (<span class="mxinfo " id="T5:U335"><span class="var type1" id="S33T5U455">SAx</span>+<span class="mxinfo " id="T5:U337"><span class="mxinfo " id="T2:U338">0.5</span>*<span class="var type1" id="S37T5U458">dSk1</span></span></span>)</span></span> )</span></span>; <span class="comment">%Change in symbiont pops at t=i+0.5 %OK</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,145" id="srcline145">145</a></span><span class="line">    <span class="mxinfo " id="T6:U340"><span class="var type1" id="S56T6U461">dCk2</span> = <span class="mxinfo " id="T6:U342"><span class="var type1" id="S7T2U463">dt</span>* (<span class="mxinfo " id="T6:U344"><span class="var type1" id="S49T6U466">hC2</span>.*(<span class="mxinfo " id="T6:U346"><span class="mxinfo " id="T6:U347"><span class="mxinfo " id="T6:U348"><span class="mxinfo " id="T6:U349"><span class="mxinfo " id="T6:U350"><span class="var type1" id="S19T6U473">G</span>.*<span class="var type1" id="S54T6U474">hSA</span></span>./(<span class="mxinfo " id="T6:U353"><span class="var type1" id="S20T6U477">KS</span>.*<span class="var type1" id="S49T6U478">hC2</span></span>)</span>.*(<span class="mxinfo " id="T6:U356"><span class="mxinfo " id="T6:U357"><span class="var type1" id="S21T6U482">KC</span>-<span class="mxinfo " id="T6:U359"><span class="var type1" id="S22T6U484">A</span>.*<span class="var type1" id="S51T6U485">hC1</span></span></span>-<span class="var type1" id="S49T6U486">hC2</span></span>)</span>./<span class="var type1" id="S21T6U487">KC</span></span>-<span class="mxinfo " id="T6:U364"><span class="var type1" id="S23T6U489">Mu</span>./(<span class="mxinfo " id="T6:U366"><span class="mxinfo " id="T2:U367">1</span>+<span class="mxinfo " id="T6:U368"><span class="mxinfo " id="T6:U369"><span class="var type1" id="S24T6U495">um</span>.*<span class="var type1" id="S54T6U496">hSA</span></span>./(<span class="mxinfo " id="T6:U372"><span class="var type1" id="S20T6U499">KS</span>.*<span class="var type1" id="S49T6U500">hC2</span></span>)</span></span>)</span></span>)</span>)</span></span>; <span class="comment">%Change in coral pops at t=i+0.5</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,146" id="srcline146">146</a></span><span class="line"><span class="comment">    <span class="comment">%{</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,147" id="srcline147">147</a></span><span class="line"><span class="comment">    if i&lt; 962 &amp;&amp; mod(i, 12) == 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,148" id="srcline148">148</a></span><span class="line"><span class="comment">        fprintf('dSk1 = <span class="comment">%7.2d %7.2d %7.2d %7.2d   dSk2 = %7.2d %7.2d %7.2d %7.2d\n', dSk1, dSk2);</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,149" id="srcline149">149</a></span><span class="line"><span class="comment">    end</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,150" id="srcline150">150</a></span><span class="line"><span class="comment">    <span class="comment">%}</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="44,151" id="srcline151">151</a></span><span class="line">    <span class="mxinfo " id="T5:U375"><span class="var type1" id="S2T5U503">Snew</span> = <span class="mxinfo " id="T5:U377">max(<span class="mxinfo " id="T5:U378"><span class="var type1" id="S4T5U507">Sold</span> + <span class="var type1" id="S55T5U508">dSk2</span></span>, <span class="var type1" id="S15T5U509">S_seed</span>)</span></span>;              <span class="comment">% Symbiont pops at t=i+1</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,152" id="srcline152">152</a></span><span class="line"><span class="comment">% dCk2 has one row, two columns</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,153" id="srcline153">153</a></span><span class="line"><span class="comment">% C_seed is also a 2x1 array.</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,154" id="srcline154">154</a></span><span class="line">    <span class="mxinfo " id="T5:U382"><span class="var type1" id="S3T5U512">Cnew</span> = <span class="mxinfo " id="T5:U384">max(<span class="mxinfo " id="T5:U385"><span class="var type1" id="S5T5U516">Cold</span> + <span class="mxinfo " id="T39:U387">repmat(<span class="var type1" id="S56T6U519">dCk2</span>,1,<span class="var type1" id="S17T2U521">Sn</span>)</span></span>, <span class="mxinfo " id="T39:U390">repmat(<span class="var type1" id="S14T6U524">C_seed</span>, 1, <span class="var type1" id="S17T2U526">Sn</span>)</span>)</span></span>; <span class="comment">% Coral pops at t=i+1</span></span></span>
<span class="srcline"><span class="lineno"><a href="44,155" id="srcline155">155</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="44,156" id="srcline156">156</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
