<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">S</span>, <span class="var type1" id="S3T1U4">C</span>, <span class="var type1" id="S4T1U5">ri</span>, <span class="var type1" id="S5T1U6">gi</span>, <span class="var type1" id="S6T1U7">vgi</span>, <span class="var type1" id="S7T2U8">origEvolved</span>] = timeIteration(<span class="var type1" id="S8T2U11">timeSteps</span>, <span class="var type1" id="S2T1U12">S</span>, <span class="var type1" id="S3T1U13">C</span>, <span class="var type1" id="S9T2U14">dt</span>, <span class="var type1" id="S4T1U15">ri</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line">        <span class="var type1" id="S10T3U16">temp</span>, <span class="var type1" id="S11T2U17">OA</span>, <span class="var type1" id="S12T4U18">omegaFactor</span>, <span class="var type1" id="S6T1U19">vgi</span>, <span class="var type1" id="S5T1U20">gi</span>, <span class="var type1" id="S13T5U21">MutVx</span>, <span class="var type1" id="S14T5U22">SelVx</span>, <span class="var type1" id="S15T6U23">C_seed</span>, <span class="var type1" id="S16T5U24">S_seed</span>, <span class="var type1" id="S17T2U25">suppressSuperIndex</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line">        <span class="var type1" id="S18T2U26">superSeedFraction</span>, <span class="var type1" id="S19T7U27">oneShot</span>, <span class="var type1" id="S20T8U28">con</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line">    <span class="mxinfo " id="T2:U25"><span class="var type1" id="S7T2U31">origEvolved</span> = <span class="mxinfo " id="T2:U27">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S21T2U35">i</span> = <span class="mxinfo " id="T2:U29">1</span>:<span class="var type1" id="S8T2U38">timeSteps</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">        <span class="mxinfo " id="T2:U31"><span class="var type1" id="S22T2U41">rm</span>  = <span class="mxinfo " id="T2:U33"><span class="mxinfo " id="T2:U34"><span class="var type1" id="S20T8U44">con</span>.a</span>*<span class="mxinfo " id="T2:U36">exp(<span class="mxinfo " id="T2:U37"><span class="mxinfo " id="T2:U38"><span class="var type1" id="S20T8U50">con</span>.b</span>*<span class="mxinfo " id="T2:U40"><span class="var type1" id="S10T3U53">temp</span>(<span class="var type1" id="S21T2U54">i</span>,<span class="mxinfo " id="T2:U43">1</span>)</span></span>)</span></span></span> ; <span class="comment">% maximum possible growth rate at optimal temp</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line">        <span class="comment">% Update of the G constant if acidification is included.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T7:U44"><span class="var type1" id="S11T2U59">OA</span> == <span class="mxinfo " id="T2:U46">1</span></span>   <span class="comment">% to include OA effects on coral growth rate in model</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">            <span class="comment">% modify growth rate based on aragonite saturation state</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">            <span class="comment">% note that omegaFactor containts the required multiplier, not</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">            <span class="comment">% the saturation state values.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">            <span class="comment">% This multiplies by factors of 0.55, 0.7, 0.85, 1.0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">            <span class="comment">% as omega steps from 1 to 4.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">            <span class="mxinfo " id="T6:U47"><span class="mxinfo " id="T6:U48"><span class="var type1" id="S20T8U64">con</span>.G</span> = <span class="mxinfo " id="T6:U50"><span class="mxinfo " id="T6:U51">[<span class="mxinfo " id="T2:U52"><span class="var type1" id="S20T8U70">con</span>.Gm</span> <span class="mxinfo " id="T2:U54"><span class="var type1" id="S20T8U73">con</span>.Gb</span>]</span> * <span class="mxinfo " id="T2:U56"><span class="var type1" id="S12T4U76">omegaFactor</span>(<span class="var type1" id="S21T2U77">i</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">        <span class="comment">%rm = 1; % try running wo Eppley eqn !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">        <span class="comment">%ri(i,:) = (1- (vgi(i,:) + EnvV + (gi(i,:) - temp(i)).^2) ./ (2*SelVx)) * rm ; % symbiont average growth rate at time i</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">         </span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line">        <span class="comment">% Original version prior to 2/1/2017:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">        <span class="comment">% ri(i,:) = (1- (vgi(i,:) + con.EnvVx + (min(0, gi(i,:) - temp(i))).^2) ./ (2*SelVx)) * rm ;% Prevents cold water bleaching</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">        <span class="comment">% Try decreasing growth rate in cooler water based on Eppley</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">        <span class="comment">% equation per John/Simon/Cheryl 2/8/2017.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">        <span class="mxinfo " id="T5:U59"><span class="mxinfo " id="T5:U60"><span class="var type1" id="S4T1U81">ri</span>(<span class="var type1" id="S21T2U82">i</span>,<span class="mxinfo " id="T9:U63">:</span>)</span> = <span class="mxinfo " id="T5:U64"><span class="mxinfo " id="T5:U65">(<span class="mxinfo " id="T5:U66"><span class="mxinfo " id="T2:U67">1</span>- <span class="mxinfo " id="T5:U68">(<span class="mxinfo " id="T5:U69"><span class="mxinfo " id="T5:U70"><span class="mxinfo " id="T5:U71"><span class="var type1" id="S6T1U94">vgi</span>(<span class="var type1" id="S21T2U95">i</span>,<span class="mxinfo " id="T9:U74">:</span>)</span> + <span class="mxinfo " id="T5:U75"><span class="var type1" id="S20T8U98">con</span>.EnvVx</span></span> + <span class="mxinfo " id="T5:U77">(<span class="mxinfo " id="T5:U78">min(<span class="mxinfo " id="T2:U79">0</span>, <span class="mxinfo " id="T5:U80"><span class="mxinfo " id="T5:U81"><span class="var type1" id="S5T1U107">gi</span>(<span class="var type1" id="S21T2U108">i</span>,<span class="mxinfo " id="T9:U84">:</span>)</span> - <span class="mxinfo " id="T2:U85"><span class="var type1" id="S10T3U111">temp</span>(<span class="var type1" id="S21T2U112">i</span>)</span></span>)</span>).^2</span></span>) ./ (<span class="mxinfo " id="T5:U88"><span class="mxinfo " id="T2:U89">2</span>*<span class="var type1" id="S14T5U117">SelVx</span></span>)</span></span>) .* <span class="mxinfo " id="T5:U91">exp(<span class="mxinfo " id="T5:U92"><span class="mxinfo " id="T2:U93"><span class="var type1" id="S20T8U122">con</span>.b</span>*<span class="mxinfo " id="T5:U95">min(<span class="mxinfo " id="T2:U96">0</span>, <span class="mxinfo " id="T5:U97"><span class="mxinfo " id="T2:U98"><span class="var type1" id="S10T3U129">temp</span>(<span class="var type1" id="S21T2U130">i</span>)</span> - <span class="mxinfo " id="T5:U101"><span class="var type1" id="S5T1U132">gi</span>(<span class="var type1" id="S21T2U133">i</span>,<span class="mxinfo " id="T9:U104">:</span>)</span></span>)</span></span>)</span></span> * <span class="var type1" id="S22T2U135">rm</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line"><span class="comment">        <span class="comment">%{</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line"><span class="comment">        if i&lt;962 &amp;&amp; mod(i, 12) == 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"><span class="comment">            fprintf('At i = 1 delta for old: <span class="comment">%7.2f  for new: %7.2f\n', gi(i,1)-temp(i), gi(i,3)-temp(i));</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"><span class="comment">            fprintf('         ri for    old: <span class="comment">%7.2f  for new: %7.2f\n', ri(i,1), ri(i, 3));</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line"><span class="comment">        end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line"><span class="comment">        <span class="comment">%}</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">38</a></span><span class="line">        <span class="comment">% Solve ordinary differential equations using 2nd order Runge Kutta</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">39</a></span><span class="line">        <span class="comment">%Runge_Kutta_2_min0_160503 %% run sub-mfile to solve ODE using min0 to prevents cold water bleaching</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line">        [<span class="var type1" id="S25T5U139">SiPlusOne</span>, <span class="var type1" id="S26T5U140">CiPlusOne</span>] = <span class="fcn" id="F205N2:B142">Runge_Kutta_2_min0_160914</span>(<span class="mxinfo " id="T5:U108"><span class="var type1" id="S2T1U144">S</span>(<span class="var type1" id="S21T2U145">i</span>, <span class="mxinfo " id="T9:U111">:</span>)</span>, <span class="mxinfo " id="T5:U112"><span class="var type1" id="S3T1U148">C</span>(<span class="var type1" id="S21T2U149">i</span>, <span class="mxinfo " id="T9:U115">:</span>)</span>, <span class="var type1" id="S21T2U151">i</span>, <span class="var type1" id="S9T2U152">dt</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line">                                            <span class="var type1" id="S4T1U153">ri</span>, <span class="var type1" id="S22T2U154">rm</span>, <span class="var type1" id="S10T3U155">temp</span>, <span class="var type1" id="S6T1U156">vgi</span>, <span class="var type1" id="S5T1U157">gi</span>, <span class="var type1" id="S14T5U158">SelVx</span>, <span class="var type1" id="S15T6U159">C_seed</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line">                                            <span class="var type1" id="S16T5U160">S_seed</span>, <span class="var type1" id="S20T8U161">con</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43">43</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44">44</a></span><span class="line">        <span class="mxinfo " id="T5:U127"><span class="mxinfo " id="T5:U128"><span class="var type1" id="S3T1U165">C</span>(<span class="mxinfo " id="T2:U130"><span class="var type1" id="S21T2U167">i</span>+<span class="mxinfo " id="T2:U132">1</span></span>, <span class="mxinfo " id="T9:U133">:</span>)</span> = <span class="var type1" id="S26T5U170">CiPlusOne</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45">45</a></span><span class="line">        <span class="mxinfo " id="T5:U135"><span class="mxinfo " id="T5:U136"><span class="var type1" id="S2T1U174">S</span>(<span class="mxinfo " id="T2:U138"><span class="var type1" id="S21T2U176">i</span>+<span class="mxinfo " id="T2:U140">1</span></span>, <span class="mxinfo " id="T9:U141">:</span>)</span> = <span class="var type1" id="S25T5U179">SiPlusOne</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46">46</a></span><span class="line">        <span class="comment">% When it's time to introduce the super symbiont, do it at a single</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47">47</a></span><span class="line">        <span class="comment">% time step.  Also reset the S_seed(:, 3:4) values to be this value if</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48">48</a></span><span class="line">        <span class="comment">% it is less than or equal the normal seed, and otherwise to match</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49">49</a></span><span class="line">        <span class="comment">% the normal seeds (S_seed(:, 1:2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50">50</a></span><span class="line">        <span class="mxinfo " id="T7:U143"><span class="keyword">if</span> <span class="mxinfo " id="T7:U144"><span class="mxinfo " id="T7:U145"><span class="var type1" id="S21T2U184">i</span> &lt; <span class="var type1" id="S17T2U185">suppressSuperIndex</span></span> || <span class="mxinfo " id="T7:U148">~<span class="var type1" id="S17T2U187">suppressSuperIndex</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51">51</a></span><span class="line">            <span class="mxinfo " id="T6:U150"><span class="mxinfo " id="T6:U151"><span class="var type1" id="S2T1U191">S</span>(<span class="mxinfo " id="T2:U153"><span class="var type1" id="S21T2U193">i</span>+<span class="mxinfo " id="T2:U155">1</span></span>, <span class="mxinfo " id="T10:U156">3:end</span>)</span> = <span class="mxinfo " id="T2:U157">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52">52</a></span><span class="line">        <span class="keyword">elseif</span> <span class="mxinfo " id="T7:U159"><span class="mxinfo " id="T7:U160"><span class="var type1" id="S21T2U203">i</span> &gt; <span class="mxinfo " id="T2:U162">1</span></span> &amp;&amp; <span class="mxinfo " id="T7:U163"><span class="var type1" id="S21T2U206">i</span> == <span class="var type1" id="S17T2U207">suppressSuperIndex</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53">53</a></span><span class="line">            <span class="mxinfo " id="T6:U166"><span class="mxinfo " id="T6:U167"><span class="var type1" id="S2T1U211">S</span>(<span class="mxinfo " id="T2:U169"><span class="var type1" id="S21T2U213">i</span>+<span class="mxinfo " id="T2:U171">1</span></span>, <span class="mxinfo " id="T6:U172"><span class="mxinfo " id="T2:U173">3</span>:<span class="mxinfo " id="T2:U174">end</span></span>)</span> = <span class="mxinfo " id="T6:U175"><span class="mxinfo " id="T6:U176"><span class="var type1" id="S16T5U221">S_seed</span>(3:end)</span> * <span class="var type1" id="S18T2U226">superSeedFraction</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54">54</a></span><span class="line">            <span class="comment">%fprintf('Introduced S3 at %7.2d i = %d\n', S(i+1, 3), (i+1));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55">55</a></span><span class="line">            <span class="keyword">if</span> <span class="var type1" id="S19T7U229">oneShot</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56">56</a></span><span class="line">                <span class="mxinfo " id="T5:U180"><span class="mxinfo " id="T5:U181"><span class="var type1" id="S16T5U233">S_seed</span>(1:end)</span> = <span class="mxinfo " id="T2:U183">0.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57">57</a></span><span class="line">            <span class="keyword">elseif</span> <span class="mxinfo " id="T7:U184"><span class="var type1" id="S18T2U241">superSeedFraction</span> &lt; <span class="mxinfo " id="T2:U186">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58">58</a></span><span class="line">                <span class="mxinfo " id="T6:U187"><span class="mxinfo " id="T6:U188"><span class="var type1" id="S16T5U246">S_seed</span>(<span class="mxinfo " id="T6:U190"><span class="mxinfo " id="T2:U191">3</span>:<span class="mxinfo " id="T2:U192">end</span></span>)</span> = <span class="mxinfo " id="T6:U193"><span class="var type1" id="S18T2U252">superSeedFraction</span> * <span class="mxinfo " id="T6:U195"><span class="var type1" id="S16T5U254">S_seed</span>(3:end)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59">59</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60">60</a></span><span class="line"><span class="comment">            <span class="comment">%{</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61">61</a></span><span class="line"><span class="comment">        elseif oneShot &amp;&amp; (i &gt; suppressSuperIndex)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62">62</a></span><span class="line"><span class="comment">            <span class="comment">% Set S to zero if small.  Do we really want this?</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63">63</a></span><span class="line"><span class="comment">            <span class="comment">% It has little impact on mortality (surprisingly), but slows</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64">64</a></span><span class="line"><span class="comment">            <span class="comment">% down runs badly.</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65">65</a></span><span class="line"><span class="comment">            S(S &lt; 1.0) = 0.0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66">66</a></span><span class="line"><span class="comment">            <span class="comment">%}</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67">67</a></span><span class="line">        <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68">68</a></span><span class="line">        <span class="comment">% Next four lines were in the Runge Kutta file, but are not part of</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69">69</a></span><span class="line">        <span class="comment">% that algorithm.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70">70</a></span><span class="line">        <span class="mxinfo " id="T5:U197"><span class="var type1" id="S29T5U261">dgi</span>  = <span class="mxinfo " id="T5:U199">(<span class="mxinfo " id="T5:U200">(<span class="mxinfo " id="T5:U201"><span class="mxinfo " id="T5:U202"><span class="var type1" id="S6T1U268">vgi</span>(<span class="var type1" id="S21T2U269">i</span>,<span class="mxinfo " id="T9:U205">:</span>)</span> .* (<span class="mxinfo " id="T5:U206"><span class="mxinfo " id="T2:U207"><span class="var type1" id="S10T3U274">temp</span>(<span class="var type1" id="S21T2U275">i</span>,<span class="mxinfo " id="T2:U210">1</span>)</span> - <span class="mxinfo " id="T5:U211"><span class="var type1" id="S5T1U278">gi</span>(<span class="var type1" id="S21T2U279">i</span>,<span class="mxinfo " id="T9:U214">:</span>)</span></span>)</span> ) ./ <span class="var type1" id="S14T5U281">SelVx</span></span>) * <span class="var type1" id="S22T2U282">rm</span></span></span>; <span class="comment">% Change in Symbiont Mean Genotype</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71">71</a></span><span class="line">        <span class="mxinfo " id="T5:U217"><span class="var type1" id="S30T5U285">dvgi</span> = <span class="mxinfo " id="T5:U219"><span class="var type1" id="S13T5U287">MutVx</span> - <span class="mxinfo " id="T5:U221"><span class="mxinfo " id="T5:U222"><span class="mxinfo " id="T5:U223">(<span class="mxinfo " id="T5:U224"><span class="var type1" id="S6T1U293">vgi</span>(<span class="var type1" id="S21T2U294">i</span>,<span class="mxinfo " id="T9:U227">:</span>)</span>) .^2</span> ./ <span class="var type1" id="S14T5U297">SelVx</span></span> * <span class="var type1" id="S22T2U298">rm</span></span></span></span> ; <span class="comment">% Change in Symbiont Mean Variance</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72">72</a></span><span class="line">        <span class="mxinfo " id="T5:U230"><span class="mxinfo " id="T5:U231"><span class="var type1" id="S5T1U302">gi</span>(<span class="mxinfo " id="T2:U233"><span class="var type1" id="S21T2U304">i</span>+<span class="mxinfo " id="T2:U235">1</span></span>,<span class="mxinfo " id="T9:U236">:</span>)</span>  =  <span class="mxinfo " id="T5:U237"><span class="mxinfo " id="T5:U238"><span class="var type1" id="S5T1U309">gi</span>(<span class="var type1" id="S21T2U310">i</span>,<span class="mxinfo " id="T9:U241">:</span>)</span> + <span class="mxinfo " id="T5:U242"><span class="var type1" id="S9T2U313">dt</span> .* <span class="var type1" id="S29T5U314">dgi</span></span></span></span>;  <span class="comment">% Symbiont genotype at t=i (Euler)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73">73</a></span><span class="line">        <span class="mxinfo " id="T5:U245"><span class="mxinfo " id="T5:U246"><span class="var type1" id="S6T1U318">vgi</span>(<span class="mxinfo " id="T2:U248"><span class="var type1" id="S21T2U320">i</span>+<span class="mxinfo " id="T2:U250">1</span></span>,<span class="mxinfo " id="T9:U251">:</span>)</span> = <span class="mxinfo " id="T5:U252"><span class="mxinfo " id="T5:U253"><span class="var type1" id="S6T1U325">vgi</span>(<span class="var type1" id="S21T2U326">i</span>,<span class="mxinfo " id="T9:U256">:</span>)</span> + <span class="mxinfo " id="T5:U257"><span class="var type1" id="S9T2U329">dt</span> .* <span class="var type1" id="S30T5U330">dvgi</span></span></span></span>; <span class="comment">% Symbiont variance at t=i (Euler)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74">74</a></span><span class="line">        <span class="mxinfo " id="T7:U260"><span class="keyword">if</span> <span class="mxinfo " id="T7:U261"><span class="mxinfo " id="T7:U262"><span class="var type1" id="S21T2U335">i</span> &gt; <span class="mxinfo " id="T2:U264">1</span></span> &amp;&amp; <span class="mxinfo " id="T7:U265"><span class="var type1" id="S21T2U338">i</span> == <span class="var type1" id="S17T2U339">suppressSuperIndex</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75">75</a></span><span class="line">            <span class="comment">% Important - enhanced genotype is set at the beginning of run,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76">76</a></span><span class="line">            <span class="comment">% but if E=1 it will have decayed.  Reset here!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77">77</a></span><span class="line">            <span class="mxinfo " id="T6:U268"><span class="mxinfo " id="T6:U269"><span class="var type1" id="S5T1U343">gi</span>(<span class="mxinfo " id="T2:U271"><span class="var type1" id="S21T2U345">i</span>+<span class="mxinfo " id="T2:U273">1</span></span>, <span class="mxinfo " id="T6:U274"><span class="mxinfo " id="T2:U275">3</span>:<span class="mxinfo " id="T2:U276">4</span></span>)</span> = <span class="mxinfo " id="T6:U277"><span class="var type1" id="S5T1U351">gi</span>(<span class="mxinfo " id="T2:U279">1</span>, <span class="mxinfo " id="T6:U280"><span class="mxinfo " id="T2:U281">3</span>:<span class="mxinfo " id="T2:U282">4</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78">78</a></span><span class="line">            <span class="mxinfo " id="T2:U283"><span class="var type1" id="S7T2U358">origEvolved</span> = <span class="mxinfo " id="T2:U285"><span class="var type1" id="S5T1U360">gi</span>(<span class="var type1" id="S21T2U361">i</span>, <span class="mxinfo " id="T2:U288">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79">79</a></span><span class="line">        <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80">80</a></span><span class="line">    <span class="keyword">end</span>  <span class="comment">% End of time iterations for one area</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81">81</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
